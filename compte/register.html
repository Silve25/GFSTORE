<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cr√©er un compte ‚Äî GF Store</title>
  <meta name="description" content="Cr√©ez votre compte GF Store pour suivre vos commandes et g√©rer vos informations.">
  <style>
    :root{
      --w:1200px; --c:#0f172a; --a:#2563eb; --bg:#f5f7fb;
      --r:16px; --eyeBtn:24px; --eyeIcon:12px;
    }
    *{box-sizing:border-box}
    body{margin:0;font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;color:var(--c);background:var(--bg)}
    a{color:inherit}

    /* Header */
    header{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid #e5e7eb;backdrop-filter:saturate(140%) blur(4px)}
    .hwrap{max-width:var(--w);margin:auto;padding:10px 12px;display:flex;justify-content:space-between;align-items:center;gap:10px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700;text-decoration:none}
    .brand .logo{height:40px;width:auto;display:block}
    .nav{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .nav a,.iconbtn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid #e5e7eb;background:#fff;border-radius:12px;text-decoration:none;box-shadow:0 1px 0 rgba(0,0,0,.02)}
    .nav a:hover,.iconbtn:hover{box-shadow:0 2px 10px rgba(0,0,0,.06)}
    .ic{width:16px;height:16px;display:inline-block}

    /* Bandeau */
    .banner{background:linear-gradient(90deg,#1e3a8a,#2563eb,#0ea5e9);color:#fff;text-align:center;padding:10px 14px}
    .banner .timer{font-weight:700;border-radius:999px;padding:2px 8px;background:rgba(255,255,255,.15);display:inline-block}
    .banner .sep{opacity:.6;padding:0 6px}

    /* Carte / Form */
    .wrap{max-width:520px;margin:18px auto 40px;padding:0 12px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:16px;box-shadow:0 1px 0 rgba(0,0,0,.02)}
    h1{font-size:18px;margin:0 0 8px}
    .muted{opacity:.75;font-size:12px}

    label{display:block;font-weight:600;margin:10px 0 6px}
    input,select{width:100%;padding:12px;border:1px solid #e5e7eb;border-radius:12px;background:#fff}
    .grid{display:grid;gap:8px}
    @media(min-width:640px){ .grid2{grid-template-columns:1fr 1fr} }
    .grid2{display:grid;gap:8px}

    .pw{position:relative}
    .pw .toggle{
      position:absolute;right:8px;top:50%;transform:translateY(-50%);
      width:var(--eyeBtn);height:var(--eyeBtn);
      border:1px solid #e5e7eb;background:#fff;border-radius:10px;
      cursor:pointer;line-height:0;padding:0;
      background-repeat:no-repeat;background-position:center;
      background-size:var(--eyeIcon) var(--eyeIcon);
    }

    .meter{height:8px;background:#f1f5f9;border-radius:999px;overflow:hidden;border:1px solid #e5e7eb;margin-top:6px}
    .meter>i{display:block;height:100%;width:0;transition:width .2s}
    .meter[data-lvl="1"]>i{width:25%;background:#ef4444}
    .meter[data-lvl="2"]>i{width:50%;background:#f59e0b}
    .meter[data-lvl="3"]>i{width:75%;background:#10b981}
    .meter[data-lvl="4"]>i{width:100%;background:#10b981}

    .btn{display:inline-flex;align-items:center;gap:8px;justify-content:center;width:100%;padding:12px;border:1px solid #1e40af;background:linear-gradient(180deg,#2563eb,#1e40af);color:#fff;border-radius:12px;cursor:pointer;box-shadow:0 6px 14px rgba(30,64,175,.25)}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .row{display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:10px}
    .alt{display:flex;gap:10px;margin-top:10px}
    .alt a{flex:1;text-align:center;border:1px solid #e5e7eb;border-radius:12px;padding:10px;text-decoration:none;background:#fff}

    .msg{margin-top:10px;padding:10px;border-radius:12px;display:none}
    #registerMsg{background:#fef2f2;border:1px solid #fee2e2;color:#991b1b} /* recoloris√© en succ√®s par showMsg() */

    footer{background:#fff;border-top:1px solid #e5e7eb}
    .fwrap{max-width:var(--w);margin:0 auto;padding:16px 12px;display:flex;flex-wrap:wrap;gap:10px;justify-content:space-between;align-items:center;font-size:12px}
    .fwrap a{text-decoration:none;color:inherit;opacity:.9}
    .fwrap a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <div class="banner">üéâ Promo sp√©ciale : <b>-25% √† -30%</b> sur PC, t√©l√©phones et consoles <span class="sep">‚Ä¢</span> <span id="countdown" class="timer" aria-live="polite"></span></div>

  <header>
    <div class="hwrap">
      <a id="homeLink" class="brand" aria-label="Accueil">
        <img src="../assets/img/logopnggfstore.png" class="logo" alt="GF Store" width="180" height="52" decoding="async">
      </a>
      <nav class="nav" aria-label="Navigation">
        <a id="loginLink"><img class="ic" id="icAccount" alt=""> Connexion</a>
        <a id="shopLink"><img class="ic" id="icHome" alt=""> Boutique</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="card">
      <h1>Cr√©er mon compte</h1>
      <div class="muted">Rejoignez GF Store pour suivre vos commandes et g√©rer vos informations.</div>

      <!-- IMPORTANT : IDs/noms attendus par auth.js -->
      <form id="registerForm" autocomplete="on" style="margin-top:10px">
        <label for="name">Nom complet</label>
        <input id="name" name="name" type="text" required placeholder="Ex. Marie Dupont" autocomplete="name" />

        <label for="email">Email</label>
        <input id="email" name="email" type="email" required placeholder="Ex. marie.dupont@example.com" inputmode="email" autocomplete="email" />

        <label for="password">Mot de passe</label>
        <div class="pw">
          <input id="password" name="password" type="password" required minlength="6" placeholder="Au moins 6 caract√®res" autocomplete="new-password" />
          <button type="button" class="toggle" data-target="password" aria-label="Afficher/Masquer le mot de passe" title="Afficher/Masquer"></button>
        </div>
        <div class="meter" id="meter"><i></i></div>

        <label for="password2">Confirmer le mot de passe</label>
        <div class="pw">
          <input id="password2" type="password" required minlength="6" placeholder="Ressaisissez le mot de passe" autocomplete="new-password" />
          <button type="button" class="toggle" data-target="password2" aria-label="Afficher/Masquer la confirmation" title="Afficher/Masquer"></button>
        </div>

        <!-- Champs optionnels -->
        <div class="grid2" style="margin-top:6px">
          <div>
            <label for="phone">T√©l√©phone (facultatif)</label>
            <input id="phone" name="phone" type="tel" inputmode="tel" placeholder="Ex. +33 6 12 34 56 78" autocomplete="tel" />
          </div>
          <div>
            <label for="country">Pays (facultatif)</label>
            <select id="country" name="country">
              <option value="">‚Äî Choisir ‚Äî</option>
              <option>France</option>
              <option>Belgique</option>
              <option>Luxembourg</option>
              <option>Suisse</option>
              <option>Allemagne</option>
              <option>Autriche</option>
              <option>Italie</option>
              <option>Espagne</option>
              <option>Portugal</option>
              <option>Pays-Bas</option>
              <option>Irlande</option>
              <option>Royaume-Uni</option>
              <option>Danemark</option>
              <option>Su√®de</option>
              <option>Norv√®ge</option>
              <option>Finlande</option>
              <option>Pologne</option>
              <option>Tch√©quie</option>
              <option>Slovaquie</option>
              <option>Hongrie</option>
              <option>Slov√©nie</option>
              <option>Croatie</option>
              <option>Roumanie</option>
              <option>Bulgarie</option>
              <option>Gr√®ce</option>
              <option>Estonie</option>
              <option>Lettonie</option>
              <option>Lituanie</option>
              <option>Malte</option>
              <option>Chypre</option>
              <option value="Other">Autre</option>
            </select>
          </div>
        </div>

        <label for="address">Adresse (facultatif)</label>
        <input id="address" name="address" type="text" placeholder="Ex. 221B Baker Street, Apt 4" autocomplete="address-line1" />

        <div class="grid2">
          <div>
            <label for="city">Ville (facultatif)</label>
            <input id="city" name="city" type="text" placeholder="Ex. Paris / Berlin / Madrid" autocomplete="address-level2" />
          </div>
          <div>
            <label for="zip">Code postal (facultatif)</label>
            <input id="zip" name="zip" type="text" placeholder="Ex. 75001, SW1A 1AA, 10115" autocomplete="postal-code" />
          </div>
        </div>

        <button id="submitBtn" class="btn" type="submit"><img class="ic" id="icLock" alt=""> Cr√©er mon compte</button>

        <!-- Zone messages utilis√©e par auth.js -> showMsg(#registerMsg, ...) -->
        <div id="registerMsg" class="msg" role="status" aria-live="polite"></div>

        <div class="alt">
          <a id="goLogin">D√©j√† inscrit ? Connexion</a>
          <a id="goShop">Retour boutique</a>
        </div>
      </form>
    </div>
  </main>

  <footer>
    <div class="fwrap">
      <div>¬© GF Store 2025 ‚Äî Simplicit√©, s√©curit√©, crypto-friendly.</div>
      <nav>
        <a id="aboutLink2">√Ä propos</a> ¬∑
        <a id="cgvLink2">CGV</a> ¬∑
        <a id="legalLink2">Mentions l√©gales</a> ¬∑
        <a id="privacyLink2">Confidentialit√©</a> ¬∑
        <a id="contactLink2">Contact</a>
      </nav>
    </div>
  </footer>

  <!-- Branche l‚ÄôAPI et la logique submit -->
  <script src="js/auth.js" defer></script>

  <script>
  (function(){
    "use strict";
    const $=(s,root)=> (root||document).querySelector(s);

    // Racine GitHub Pages
    const GH_ROOT = (()=>{ 
      const parts = location.pathname.split('/').filter(Boolean);
      return (location.host.endsWith('github.io') && parts.length) ? `/${parts[0]}/` : '/';
    })();

    // Ic√¥nes (petites)
    const ICONS = {
      account:'https://img.icons8.com/?size=100&id=60655&format=png&color=000000',
      home:   'https://img.icons8.com/?size=100&id=98956&format=png&color=000000',
      lock:   'https://img.icons8.com/?size=100&id=107272&format=png&color=000000',
      eye:    'https://img.icons8.com/?size=100&id=986&format=png&color=000000',
      eyeOff: 'https://img.icons8.com/?size=100&id=59814&format=png&color=000000'
    };

    function link(id,path){ const el=document.getElementById(id); if(el) el.href=GH_ROOT+path; }

    function wireLinks(){
      $('#homeLink').href = GH_ROOT;
      link('loginLink','compte/login.html');
      link('shopLink','index.html');
      link('goLogin','compte/login.html');
      link('goShop','index.html');
      const pages = {about:'a-propos', cgv:'cgv', legal:'mentions-legales', privacy:'confidentialite', contact:'contact'};
      Object.entries(pages).forEach(([k,slug])=>link(k+'Link2','pages/'+slug+'.html'));
    }

    // Compte √† rebours (48h)
    const countdownEl = $('#countdown');
    const SALE_END = new Date(Date.now()+48*60*60*1000);
    const two = n => String(n).padStart(2,'0');
    function tick(){
      if(!countdownEl) return;
      const now=new Date(); let diff=SALE_END-now;
      if(diff<=0){ countdownEl.textContent='Derni√®res heures !'; return; }
      const d=Math.floor(diff/86400000); diff%=86400000;
      const h=Math.floor(diff/3600000); diff%=3600000;
      const m=Math.floor(diff/60000); const s=Math.floor((diff%60000)/1000);
      countdownEl.textContent=`${d?d+'j ':''}${two(h)}:${two(m)}:${two(s)} restants`;
    }

    // ≈íil (TRES PETIT) + force + confirmation
    function wirePasswordUI(){
      // toggles ≈ìil (minis)
      document.querySelectorAll('.pw .toggle').forEach(btn=>{
        const id=btn.getAttribute('data-target');
        const input=document.getElementById(id);
        if(!input) return;
        // init petite ic√¥ne
        btn.style.backgroundImage = `url(${ICONS.eye})`;
        btn.addEventListener('click',()=>{
          const show = input.type === 'password';
          input.type = show ? 'text' : 'password';
          btn.style.backgroundImage = `url(${show ? ICONS.eyeOff : ICONS.eye})`;
        });
      });

      // m√®tre de force (simple)
      const meter = document.getElementById('meter');
      const pw = document.getElementById('password');
      function strength(v){
        let s=0; if(v.length>=6) s++; if(/[A-Z]/.test(v)) s++; if(/[a-z]/.test(v)) s++; if(/[0-9\W_]/.test(v)) s++;
        return Math.min(s,4);
      }
      function updateMeter(){ if(meter && pw) meter.setAttribute('data-lvl', String(strength(pw.value)||0)); }
      if(pw){ pw.addEventListener('input', updateMeter); updateMeter(); }

      // confirmation : bloque la soumission native si mismatch
      const pw2 = document.getElementById('password2');
      function validateMatch(){
        if(!pw || !pw2) return;
        if(pw2.value && pw.value !== pw2.value){
          pw2.setCustomValidity('Les mots de passe ne correspondent pas.');
        }else{
          pw2.setCustomValidity('');
        }
      }
      if(pw && pw2){
        pw.addEventListener('input', validateMatch);
        pw2.addEventListener('input', validateMatch);
      }
    }

    // D√©j√† connect√© ? -> dashboard
    function maybeRedirectIfLogged(){
      try{
        const s = JSON.parse(localStorage.getItem('GF_SESSION')||'null');
        if(s && s.email){ location.replace(GH_ROOT + 'compte/index.html'); }
      }catch{/* ignore */}
    }

    // petites ic√¥nes dans la nav et bouton
    function setNavIcons(){
      const set=(id,src)=>{ const el=document.getElementById(id); if(el) el.src=src; };
      set('icAccount', ICONS.account);
      set('icHome', ICONS.home);
      set('icLock', ICONS.lock);
    }

    function init(){
      wireLinks();
      setNavIcons();
      wirePasswordUI();
      maybeRedirectIfLogged();
      tick(); setInterval(tick,1000);
    }
    document.addEventListener('DOMContentLoaded', init);
  })();
  </script>
</body>
</html>
